(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     15635,        385]
NotebookOptionsPosition[     13511,        344]
NotebookOutlinePosition[     13916,        360]
CellTagsIndexPosition[     13873,        357]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Questo", " ", "\[EGrave]", " ", "la", " ", "rappresentazione", " ", 
    "come", " ", "vettore", " ", "del", " ", "polinomio", " ", "irr", " ", 
    "per", " ", "AES"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"f", " ", "=", " ", 
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "0", ",", 
       "1"}], "}"}], ",", " ", "2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.825331210869513*^9, 3.8253312189129143`*^9}, {
  3.825334750278965*^9, 3.825334786817184*^9}, {3.825335050617239*^9, 
  3.825335055051177*^9}},
 CellLabel->"In[1]:=",ExpressionUUID->"de30b4eb-4339-4b10-b7da-95f8dab52caf"],

Cell[BoxData["157"], "Output",
 CellChangeTimes->{
  3.825331219326808*^9, 3.825333363828272*^9, 3.8253335825412903`*^9, 
   3.825333884048772*^9, {3.825334776757639*^9, 3.825334787272191*^9}, 
   3.825334918556384*^9, 3.825335063968644*^9, 3.825335337039811*^9, 
   3.8253353820775747`*^9, 3.825337053782569*^9},
 CellLabel->"Out[1]=",ExpressionUUID->"8aeb7452-0711-4809-af98-015fcfa1137a"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Il", " ", "corpo", " ", "del", " ", "loop", " ", "interno"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Loope", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BitShiftRight", "[", 
      RowBox[{"u", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "v", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BitAnd", "[", 
         RowBox[{"g1", ",", "1"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"BitShiftRight", "[", 
        RowBox[{"g1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"BitShiftRight", "[", 
        RowBox[{
         RowBox[{"BitXor", "[", 
          RowBox[{"g1", ",", "f"}], "]"}], ",", " ", "1"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", "g2"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.825331008599531*^9, 3.8253310327733393`*^9}, {
   3.825331129077175*^9, 3.825331234613514*^9}, {3.825331454711133*^9, 
   3.825331496726204*^9}, {3.825331530821316*^9, 3.825331543157876*^9}, {
   3.825331860392152*^9, 3.825331909257655*^9}, 3.825332027748007*^9, {
   3.825335067138373*^9, 3.8253350803951197`*^9}},
 CellLabel->"In[2]:=",ExpressionUUID->"72741d41-326c-4a5c-8703-8e3d5a917067"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Il", " ", "loop", " ", "interno", " ", "viene", " ", "valutato", " ", 
    "finch\[EAcute]", " ", "u", " ", "non", " ", "\[EGrave]", " ", 
    "divisibile", " ", 
    RowBox[{"per", " ", "\\", "alpha"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xloope", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"NestWhile", "[", 
    RowBox[{"Loope", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "g1", ",", "g2"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"BitAnd", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], " ", "\[Equal]", 
       " ", "0"}], " ", "&"}]}], "]"}], " "}]}]], "Input",
 CellChangeTimes->{
  3.8253319254160852`*^9, {3.825333816121472*^9, 3.825333816181169*^9}, {
   3.825335085065652*^9, 3.825335135934951*^9}},
 CellLabel->"In[3]:=",ExpressionUUID->"ab1b2a90-e06e-4549-8f34-c7b493ef75f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Se", " ", "u"}], "=", 
     RowBox[{"1", " ", "abbiamo", " ", "trovato", " ", 
      RowBox[{"l", "'"}], " ", "inverso", " ", "di", " ", "u", " ", 
      "originale"}]}], ",", " ", 
    RowBox[{"\[EGrave]", " ", "in", " ", "g1"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Hackish", "..."}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xit", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", "g1_", ",", "g2_"}], "}"}], "]"}], " ", ":=",
    " ", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"u", " ", "\[Equal]", " ", "1"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<l'inverso \[EGrave]: \>\"", ",", "g1"}], "]"}], " ", ",", 
     " ", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "g1", ",", "g2"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8253324759541597`*^9, 3.825332535738359*^9}, {
   3.8253349009021997`*^9, 3.8253349025880423`*^9}, {3.825334950390444*^9, 
   3.82533495487319*^9}, {3.825335138964973*^9, 3.825335187244905*^9}, 
   3.8253355117917633`*^9},
 CellLabel->"In[4]:=",ExpressionUUID->"4a3a05fa-b606-45e9-a21f-6bc703e74843"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Scambio", " ", "u", " ", "con", " ", "v", " ", "e", " ", "g1", " ", "con",
     " ", "g2", " ", "se", " ", 
    RowBox[{"c", "'"}], "\[EGrave]", " ", "bisogno"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xswap", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"v", ">", "u"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "u", ",", "g2", ",", "g1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "g1", ",", "g2"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8253312850781393`*^9, 3.8253313394896383`*^9}, {
  3.825334651153625*^9, 3.825334703721966*^9}, {3.8253351969481583`*^9, 
  3.825335219284182*^9}},
 CellLabel->"In[5]:=",ExpressionUUID->"44ef4fb5-0e07-4f2b-b516-cf8285ca4e74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Sommo", " ", "nel", " ", "campo", " ", "GF", 
    RowBox[{"(", 
     RowBox[{"2", "^", "8"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xsum", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BitXor", "[", 
      RowBox[{"u", ",", "v"}], "]"}], ",", "v", ",", " ", 
     RowBox[{"BitXor", "[", 
      RowBox[{"g1", ",", "g2"}], "]"}], ",", "g2"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.825331367489698*^9, 3.825331418657868*^9}, {
  3.825331945975799*^9, 3.825331954170102*^9}, {3.8253352246687803`*^9, 
  3.8253352388163233`*^9}},
 CellLabel->"In[6]:=",ExpressionUUID->"c11d02c3-de4c-4e4b-be15-2a228df96fe2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Questa", " ", "\[EGrave]", " ", "la", " ", "pipeline", " ", "che", " ", 
    "rappresenta", " ", "un", " ", "ciclo", " ", "completo", " ", 
    RowBox[{"dell", "'"}], " ", "Algoritmo"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{"pipeline", " ", "=", " ", 
   RowBox[{
   "Xloope", " ", "/*", " ", "Xit", " ", "/*", " ", "Xswap", " ", "/*", " ", 
    "Xsum", " "}]}]}]], "Input",
 CellChangeTimes->{{3.8253324359480753`*^9, 3.8253324359620743`*^9}, {
   3.8253325777124653`*^9, 3.8253326153676443`*^9}, {3.825333048164596*^9, 
   3.8253331097652884`*^9}, 3.8253332497139378`*^9, {3.825333597639163*^9, 
   3.8253335987690353`*^9}, {3.825333915721828*^9, 3.825333929135951*^9}, {
   3.8253339988110237`*^9, 3.8253340009036694`*^9}, {3.825335244389792*^9, 
   3.825335274462281*^9}, {3.825336177307942*^9, 3.8253361797042627`*^9}, {
   3.8253362921025963`*^9, 3.825336315848579*^9}, 3.8253370393476467`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"3fe46f1a-a016-43a9-a09b-87406233436b"],

Cell[BoxData[
 RowBox[{"Xloope", "/*", "Xit", "/*", "Xswap", "/*", "Xsum"}]], "Output",
 CellChangeTimes->{
  3.8253339294286118`*^9, 3.825334001374317*^9, 3.825334918703587*^9, 
   3.8253352764948893`*^9, 3.825335337146718*^9, 3.8253353821774406`*^9, 
   3.8253361828168707`*^9, 3.825336316232604*^9, {3.8253370430328293`*^9, 
   3.825337053881681*^9}},
 CellLabel->"Out[7]=",ExpressionUUID->"e7ba1d91-3c2c-47de-b4d9-1eaec3226769"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"256", ",", "2", ",", "3", ",", "4"}], "}"}], " ", "//", 
   "pipeline"}], "  ", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.825333936745043*^9, 3.825333947563209*^9}, {
  3.825334089804678*^9, 3.825334099780623*^9}, {3.825336154995418*^9, 
  3.825336155695136*^9}, {3.825336194411275*^9, 3.8253362022056713`*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"53a3b08b-94fe-4c3a-9933-091f74932c8e"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"l'inverso \[EGrave]: \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["l'inverso \[EGrave]: ", 10],
  Editable->False]], "Print",
 CellChangeTimes->{3.825336317902014*^9, 3.8253370539114647`*^9},
 CellLabel->
  "During evaluation of \
In[8]:=",ExpressionUUID->"e34a7c4f-8e80-4be5-a2a7-8cd5b48e9bbc"],

Cell[BoxData[
 RowBox[{"Xsum", "[", 
  RowBox[{"Xswap", "[", "Null", "]"}], "]"}]], "Output",
 CellChangeTimes->{
  3.8253339483231173`*^9, 3.825334002793817*^9, 3.825334100290586*^9, 
   3.825334918732654*^9, 3.825335337175125*^9, 3.825335382203787*^9, {
   3.825336157815744*^9, 3.825336202656734*^9}, 3.8253363179086123`*^9, 
   3.825337053915765*^9},
 CellLabel->"Out[8]=",ExpressionUUID->"5915132b-8b58-4873-9ea1-e2f7b334dba5"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"256", ",", "2", ",", "3", ",", "4"}], "}"}], " ", "//", " ", 
     "Xloope"}], " ", "//", " ", "Xit"}], " ", "//", " ", "Xswap"}], " ", "//",
   " ", "Xsum"}]], "Input",
 CellChangeTimes->{{3.825333767402248*^9, 3.8253337730322247`*^9}, {
  3.825334153706081*^9, 3.8253341568071537`*^9}, {3.825334192046081*^9, 
  3.8253342434827957`*^9}, {3.825334928100767*^9, 3.8253349291051197`*^9}, {
  3.825334965815889*^9, 3.825334974206003*^9}, {3.825335320265036*^9, 
  3.825335322591853*^9}, {3.825335524374576*^9, 3.825335540251081*^9}},
 CellLabel->"In[9]:=",ExpressionUUID->"a625acc9-1163-4322-9056-a98bde1d4943"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"l'inverso \[EGrave]: \"\>", "\[InvisibleSpace]", "10"}],
  SequenceForm["l'inverso \[EGrave]: ", 10],
  Editable->False]], "Print",
 CellChangeTimes->{3.825335540579472*^9, 3.825337053954466*^9},
 CellLabel->
  "During evaluation of \
In[9]:=",ExpressionUUID->"176260b9-1a69-421d-ab42-8c8c3fde7b4d"],

Cell[BoxData[
 RowBox[{"Xsum", "[", 
  RowBox[{"Xswap", "[", "Null", "]"}], "]"}]], "Output",
 CellChangeTimes->{
  3.825333884266613*^9, 3.825334012094594*^9, 3.825334157204781*^9, {
   3.825334192730176*^9, 3.825334243931809*^9}, {3.825334918792164*^9, 
   3.82533492956103*^9}, {3.825334962207335*^9, 3.825334984257893*^9}, {
   3.825335322989286*^9, 3.825335337240456*^9}, 3.825335382289373*^9, {
   3.8253355214930763`*^9, 3.825335540585791*^9}, 3.82533705395975*^9},
 CellLabel->"Out[9]=",ExpressionUUID->"f57690b7-6625-4a53-8c6e-8380ff88c897"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"NestWhileList", "[", 
  RowBox[{"pipeline", ",", " ", 
   RowBox[{"{", 
    RowBox[{"64", ",", "2", ",", "3", ",", "4"}], "}"}], ",", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", "#", "]"}], " ", ">", " ", "1"}], " ", "&"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.825334317106821*^9, 3.825334443977078*^9}, {
  3.825335340429043*^9, 3.825335464319564*^9}, {3.825335563516138*^9, 
  3.8253355693952103`*^9}, {3.825336448936029*^9, 3.82533645237014*^9}, {
  3.8253364825032587`*^9, 3.8253365654794893`*^9}, {3.825336724849943*^9, 
  3.825336725046864*^9}, {3.8253369595580463`*^9, 3.825337016926787*^9}},
 CellLabel->"In[10]:=",ExpressionUUID->"53496947-6b8d-4f94-aa89-f85d2b139864"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"l'inverso \[EGrave]: \"\>", "\[InvisibleSpace]", "40"}],
  SequenceForm["l'inverso \[EGrave]: ", 40],
  Editable->False]], "Print",
 CellChangeTimes->{3.8253365660200863`*^9, 3.825336725557261*^9, 
  3.825336986387828*^9, 3.825337053981476*^9},
 CellLabel->
  "During evaluation of \
In[10]:=",ExpressionUUID->"026d1e0e-1fd1-4bd2-b4be-e600f3a14102"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"64", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"Xsum", "[", 
    RowBox[{"Xswap", "[", "Null", "]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.825335433572348*^9, 3.825335464773985*^9}, {
   3.825335563823929*^9, 3.825335570035988*^9}, 3.825336322994336*^9, 
   3.8253364529984818`*^9, {3.825336483073484*^9, 3.825336570034101*^9}, 
   3.825336725560915*^9, 3.825336986395109*^9, 3.825337053984846*^9},
 CellLabel->"Out[10]=",ExpressionUUID->"a5095c2b-3c61-4e0e-ba12-929ee0033af2"]
}, Open  ]]
},
WindowSize->{694.5, 537.},
WindowMargins->{{135.75, Automatic}, {-27.75, Automatic}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c3ab085c-f74a-46a8-ae5a-f8ca227e6f6c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 747, 17, 51, "Input",ExpressionUUID->"de30b4eb-4339-4b10-b7da-95f8dab52caf"],
Cell[1330, 41, 391, 6, 33, "Output",ExpressionUUID->"8aeb7452-0711-4809-af98-015fcfa1137a"]
}, Open  ]],
Cell[1736, 50, 1418, 32, 154, "Input",ExpressionUUID->"72741d41-326c-4a5c-8703-8e3d5a917067"],
Cell[3157, 84, 1091, 27, 71, "Input",ExpressionUUID->"ab1b2a90-e06e-4549-8f34-c7b493ef75f6"],
Cell[4251, 113, 1250, 31, 92, "Input",ExpressionUUID->"4a3a05fa-b606-45e9-a21f-6bc703e74843"],
Cell[5504, 146, 961, 24, 71, "Input",ExpressionUUID->"44ef4fb5-0e07-4f2b-b516-cf8285ca4e74"],
Cell[6468, 172, 843, 20, 71, "Input",ExpressionUUID->"c11d02c3-de4c-4e4b-be15-2a228df96fe2"],
Cell[CellGroupData[{
Cell[7336, 196, 1048, 19, 71, "Input",ExpressionUUID->"3fe46f1a-a016-43a9-a09b-87406233436b"],
Cell[8387, 217, 432, 7, 33, "Output",ExpressionUUID->"e7ba1d91-3c2c-47de-b4d9-1eaec3226769"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8856, 229, 469, 9, 51, "Input",ExpressionUUID->"53a3b08b-94fe-4c3a-9933-091f74932c8e"],
Cell[9328, 240, 350, 8, 23, "Print",ExpressionUUID->"e34a7c4f-8e80-4be5-a2a7-8cd5b48e9bbc"],
Cell[9681, 250, 432, 8, 33, "Output",ExpressionUUID->"5915132b-8b58-4873-9ea1-e2f7b334dba5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10150, 263, 703, 14, 29, "Input",ExpressionUUID->"a625acc9-1163-4322-9056-a98bde1d4943"],
Cell[10856, 279, 348, 8, 23, "Print",ExpressionUUID->"176260b9-1a69-421d-ab42-8c8c3fde7b4d"],
Cell[11207, 289, 550, 9, 33, "Output",ExpressionUUID->"f57690b7-6625-4a53-8c6e-8380ff88c897"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11794, 303, 724, 14, 29, "Input",ExpressionUUID->"53496947-6b8d-4f94-aa89-f85d2b139864"],
Cell[12521, 319, 398, 9, 23, "Print",ExpressionUUID->"026d1e0e-1fd1-4bd2-b4be-e600f3a14102"],
Cell[12922, 330, 573, 11, 82, "Output",ExpressionUUID->"a5095c2b-3c61-4e0e-ba12-929ee0033af2"]
}, Open  ]]
}
]
*)

