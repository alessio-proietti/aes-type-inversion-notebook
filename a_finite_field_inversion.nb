(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     16738,        386]
NotebookOptionsPosition[     15018,        351]
NotebookOutlinePosition[     15423,        367]
CellTagsIndexPosition[     15380,        364]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "\[CapitalEGrave]", " ", "un", " ", "elemento", " ", "del", " ", "campo", 
    " ", "da", " ", "invertire"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"a", " ", "=", " ", 
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", 
       "0"}], "}"}], ",", " ", "2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.825348739761589*^9, 3.8253487971728086`*^9}, {
  3.825424151718607*^9, 3.825424152130343*^9}},
 CellLabel->"In[55]:=",ExpressionUUID->"08958795-8b98-4b71-b68e-f52ccc3dbafd"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.825348807930969*^9, {3.825422468240445*^9, 3.825422503540635*^9}, 
   3.825424155547175*^9, 3.825424469889863*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"78df887f-dfcc-40ab-a3e7-b2655b8839bb"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Questo", " ", "\[EGrave]", " ", "la", " ", "rappresentazione", " ", 
    "come", " ", "vettore", " ", "del", " ", "polinomio", " ", "irr", " ", 
    "per", " ", "AES"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"f", " ", "=", " ", 
   RowBox[{"FromDigits", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", 
       "1", ",", "1"}], "}"}], ",", " ", "2"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.825331210869513*^9, 3.8253312189129143`*^9}, {
  3.825334750278965*^9, 3.825334786817184*^9}, {3.825335050617239*^9, 
  3.825335055051177*^9}, {3.825347850168394*^9, 3.825347850813971*^9}, {
  3.8253479591175327`*^9, 3.8253479616497097`*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"de30b4eb-4339-4b10-b7da-95f8dab52caf"],

Cell[BoxData["283"], "Output",
 CellChangeTimes->{
  3.825331219326808*^9, 3.825333363828272*^9, 3.8253335825412903`*^9, 
   3.825333884048772*^9, {3.825334776757639*^9, 3.825334787272191*^9}, 
   3.825334918556384*^9, 3.825335063968644*^9, 3.825335337039811*^9, 
   3.8253353820775747`*^9, 3.825337053782569*^9, 3.825340029608018*^9, 
   3.825340095335787*^9, 3.82534282784678*^9, 3.825343049956501*^9, 
   3.825343310103531*^9, 3.825347858031111*^9, 3.8253479850428267`*^9, 
   3.8253488079814157`*^9, {3.8254224682958117`*^9, 3.8254225035959177`*^9}, 
   3.825424155603009*^9, 3.825424469935377*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"d08cc351-3f4d-4cd5-8374-8acae581de21"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Il", " ", "corpo", " ", "del", " ", "loop", " ", "interno"}], " ",
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Loope", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BitShiftRight", "[", 
      RowBox[{"u", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", "v", ",", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"BitAnd", "[", 
         RowBox[{"g1", ",", "1"}], "]"}], "\[Equal]", "0"}], ",", 
       RowBox[{"BitShiftRight", "[", 
        RowBox[{"g1", ",", "1"}], "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"BitShiftRight", "[", 
        RowBox[{
         RowBox[{"BitXor", "[", 
          RowBox[{"g1", ",", "f"}], "]"}], ",", " ", "1"}], "]"}]}], "]"}], 
     ",", "\[IndentingNewLine]", "g2"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.825331008599531*^9, 3.8253310327733393`*^9}, {
   3.825331129077175*^9, 3.825331234613514*^9}, {3.825331454711133*^9, 
   3.825331496726204*^9}, {3.825331530821316*^9, 3.825331543157876*^9}, {
   3.825331860392152*^9, 3.825331909257655*^9}, 3.825332027748007*^9, {
   3.825335067138373*^9, 3.8253350803951197`*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"72741d41-326c-4a5c-8703-8e3d5a917067"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Il", " ", "loop", " ", "interno", " ", "viene", " ", "valutato", " ", 
    "finch\[EAcute]", " ", "u", " ", "non", " ", "\[EGrave]", " ", 
    "divisibile", " ", 
    RowBox[{"per", " ", "\\", "alpha"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xloope", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"NestWhile", "[", 
    RowBox[{"Loope", ",", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "g1", ",", "g2"}], "}"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"BitAnd", "[", 
        RowBox[{
         RowBox[{"#", "[", 
          RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "]"}], " ", "\[Equal]", 
       " ", "0"}], " ", "&"}]}], "]"}], " "}]}]], "Input",
 CellChangeTimes->{
  3.8253319254160852`*^9, {3.825333816121472*^9, 3.825333816181169*^9}, {
   3.825335085065652*^9, 3.825335135934951*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"ab1b2a90-e06e-4549-8f34-c7b493ef75f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Se", " ", "u"}], "=", 
     RowBox[{"1", " ", "abbiamo", " ", "trovato", " ", 
      RowBox[{"l", "'"}], " ", "inverso", " ", "di", " ", "u", " ", 
      "originale"}]}], ",", " ", 
    RowBox[{"\[EGrave]", " ", "in", " ", "g1"}]}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Hackish", "..."}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xit", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", "g1_", ",", "g2_"}], "}"}], "]"}], " ", ":=",
    " ", "\[IndentingNewLine]", 
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{"u", " ", "\[Equal]", " ", "1"}], ",", 
     RowBox[{"Print", "[", 
      RowBox[{"\"\<l'inverso \[EGrave]: \>\"", ",", 
       RowBox[{"IntegerDigits", "[", 
        RowBox[{"g1", ",", "2"}], "]"}], ",", "\"\< ovvero: \>\"", ",", " ", 
       "g1"}], "]"}], " ", ",", " ", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "g1", ",", "g2"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8253324759541597`*^9, 3.825332535738359*^9}, {
   3.8253349009021997`*^9, 3.8253349025880423`*^9}, {3.825334950390444*^9, 
   3.82533495487319*^9}, {3.825335138964973*^9, 3.825335187244905*^9}, 
   3.8253355117917633`*^9, {3.825422403719223*^9, 3.825422499279845*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"4a3a05fa-b606-45e9-a21f-6bc703e74843"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Scambio", " ", "u", " ", "con", " ", "v", " ", "e", " ", "g1", " ", "con",
     " ", "g2", " ", "se", " ", 
    RowBox[{"c", "'"}], "\[EGrave]", " ", "bisogno"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xswap", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"If", "[", " ", 
    RowBox[{
     RowBox[{"v", ">", "u"}], ",", 
     RowBox[{"{", 
      RowBox[{"v", ",", "u", ",", "g2", ",", "g1"}], "}"}], ",", " ", 
     RowBox[{"{", 
      RowBox[{"u", ",", "v", ",", "g1", ",", "g2"}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.8253312850781393`*^9, 3.8253313394896383`*^9}, {
  3.825334651153625*^9, 3.825334703721966*^9}, {3.8253351969481583`*^9, 
  3.825335219284182*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"44ef4fb5-0e07-4f2b-b516-cf8285ca4e74"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Sommo", " ", "nel", " ", "campo", " ", "GF", 
    RowBox[{"(", 
     RowBox[{"2", "^", "8"}], ")"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Xsum", "[", 
    RowBox[{"{", 
     RowBox[{"u_", ",", "v_", ",", " ", "g1_", ",", " ", "g2_"}], "}"}], 
    "]"}], " ", ":=", " ", "\[IndentingNewLine]", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"BitXor", "[", 
      RowBox[{"u", ",", "v"}], "]"}], ",", "v", ",", " ", 
     RowBox[{"BitXor", "[", 
      RowBox[{"g1", ",", "g2"}], "]"}], ",", "g2"}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.825331367489698*^9, 3.825331418657868*^9}, {
  3.825331945975799*^9, 3.825331954170102*^9}, {3.8253352246687803`*^9, 
  3.8253352388163233`*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"c11d02c3-de4c-4e4b-be15-2a228df96fe2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Questa", " ", "\[EGrave]", " ", "la", " ", "pipeline", " ", "che", " ", 
    "rappresenta", " ", "un", " ", "ciclo", " ", "completo", " ", 
    RowBox[{"dell", "'"}], " ", "Algoritmo"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{"pipeline", " ", "=", " ", 
   RowBox[{
   "Xloope", " ", "/*", " ", "Xit", " ", "/*", " ", "Xswap", " ", "/*", " ", 
    "Xsum", " "}]}]}]], "Input",
 CellChangeTimes->{{3.8253324359480753`*^9, 3.8253324359620743`*^9}, {
   3.8253325777124653`*^9, 3.8253326153676443`*^9}, {3.825333048164596*^9, 
   3.8253331097652884`*^9}, 3.8253332497139378`*^9, {3.825333597639163*^9, 
   3.8253335987690353`*^9}, {3.825333915721828*^9, 3.825333929135951*^9}, {
   3.8253339988110237`*^9, 3.8253340009036694`*^9}, {3.825335244389792*^9, 
   3.825335274462281*^9}, {3.825336177307942*^9, 3.8253361797042627`*^9}, {
   3.8253362921025963`*^9, 3.825336315848579*^9}, 3.8253370393476467`*^9, 
   3.825343290088273*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"3fe46f1a-a016-43a9-a09b-87406233436b"],

Cell[BoxData[
 RowBox[{"Xloope", "/*", "Xit", "/*", "Xswap", "/*", "Xsum"}]], "Output",
 CellChangeTimes->{
  3.8253339294286118`*^9, 3.825334001374317*^9, 3.825334918703587*^9, 
   3.8253352764948893`*^9, 3.825335337146718*^9, 3.8253353821774406`*^9, 
   3.8253361828168707`*^9, 3.825336316232604*^9, {3.8253370430328293`*^9, 
   3.825337053881681*^9}, 3.82534002972406*^9, 3.825340095503203*^9, 
   3.825342827958186*^9, 3.825343050056925*^9, 3.8253433102065563`*^9, 
   3.825347858124179*^9, 3.825347985147153*^9, 3.825348808036367*^9, {
   3.825422468392769*^9, 3.825422503703545*^9}, 3.8254241557155523`*^9, 
   3.825424470049164*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"d3637f32-66b6-449a-9a1b-a9b2e8c02d6f"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Loop", " ", "principale"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"NestWhileList", "[", 
   RowBox[{"pipeline", ",", " ", 
    RowBox[{"{", 
     RowBox[{"a", ",", "f", ",", "1", ",", "0"}], "}"}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", "#", "]"}], " ", ">", " ", "1"}], " ", "&"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.825334317106821*^9, 3.825334443977078*^9}, {
   3.825335340429043*^9, 3.825335464319564*^9}, {3.825335563516138*^9, 
   3.8253355693952103`*^9}, {3.825336448936029*^9, 3.82533645237014*^9}, {
   3.8253364825032587`*^9, 3.8253365654794893`*^9}, {3.825336724849943*^9, 
   3.825336725046864*^9}, {3.8253369595580463`*^9, 3.825337016926787*^9}, {
   3.8253400088145037`*^9, 3.825340021883522*^9}, 3.825340089728387*^9, {
   3.825340216735227*^9, 3.825340217042774*^9}, {3.8253428581081657`*^9, 
   3.825342858691937*^9}, 3.825343215517475*^9, {3.8253432460344543`*^9, 
   3.825343246919574*^9}, {3.825343295422291*^9, 3.825343316377569*^9}, {
   3.825343355148326*^9, 3.825343355216913*^9}, {3.825343388730513*^9, 
   3.8253433891691027`*^9}, {3.8253434210877*^9, 3.8253434704836407`*^9}, {
   3.825343597994145*^9, 3.825343598680154*^9}, {3.825343658331168*^9, 
   3.825343658449792*^9}, {3.8253437071511993`*^9, 3.825343711178318*^9}, {
   3.825343846952286*^9, 3.825343847343104*^9}, {3.82534589929887*^9, 
   3.825345900956833*^9}, {3.825347916731101*^9, 3.825347917107871*^9}, 
   3.825348804931242*^9},
 CellLabel->"In[63]:=",ExpressionUUID->"53496947-6b8d-4f94-aa89-f85d2b139864"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"\<\"l'inverso \[EGrave]: \"\>", "\[InvisibleSpace]", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "1", ",", "1"}],
     "}"}], "\[InvisibleSpace]", "\<\" ovvero: \"\>", "\[InvisibleSpace]", 
   "123"}],
  SequenceForm[
  "l'inverso \[EGrave]: ", {1, 1, 1, 1, 0, 1, 1}, " ovvero: ", 123],
  Editable->False]], "Print",
 CellChangeTimes->{
  3.8253365660200863`*^9, 3.825336725557261*^9, 3.825336986387828*^9, 
   3.825337053981476*^9, 3.825340029776033*^9, 3.825340095556818*^9, 
   3.825340222511516*^9, 3.825342828011554*^9, 3.8253428618953323`*^9, 
   3.825343050071224*^9, 3.8253432160768747`*^9, 3.8253432499855423`*^9, {
   3.825343310229952*^9, 3.825343318655364*^9}, {3.8253433745319347`*^9, 
   3.825343390159841*^9}, 3.82534342849658*^9, {3.8253434636342583`*^9, 
   3.82534347361518*^9}, 3.825343600027895*^9, 3.825343660010716*^9, 
   3.825343712275728*^9, 3.825343847786373*^9, 3.825345901359894*^9, 
   3.8253478581432047`*^9, 3.825347917661749*^9, 3.825347985167397*^9, 
   3.82534880805243*^9, {3.825422468426166*^9, 3.825422503730764*^9}, 
   3.82542415575366*^9, 3.825424470109229*^9},
 CellLabel->
  "During evaluation of \
In[63]:=",ExpressionUUID->"0fbd575f-e6ce-42b2-a7fb-1f4318b715c8"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"6", ",", "283", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"280", ",", "3", ",", "141", ",", "141"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"32", ",", "3", ",", "249", ",", "141"}], "}"}], ",", 
   RowBox[{"Xsum", "[", 
    RowBox[{"Xswap", "[", "Null", "]"}], "]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.825335433572348*^9, 3.825335464773985*^9}, {
   3.825335563823929*^9, 3.825335570035988*^9}, 3.825336322994336*^9, 
   3.8253364529984818`*^9, {3.825336483073484*^9, 3.825336570034101*^9}, 
   3.825336725560915*^9, 3.825336986395109*^9, 3.825337053984846*^9, 
   3.8253400297773123`*^9, 3.825340095558362*^9, 3.825340222516943*^9, 
   3.825342828013174*^9, 3.825342861899329*^9, 3.825343050072386*^9, 
   3.825343216080708*^9, 3.825343249989688*^9, {3.825343310231387*^9, 
   3.8253433186597223`*^9}, {3.8253433745357428`*^9, 3.825343390163733*^9}, 
   3.8253434285005713`*^9, {3.8253434636383257`*^9, 3.82534347361924*^9}, 
   3.8253436000322123`*^9, 3.8253436600151653`*^9, 3.825343712277169*^9, 
   3.825343847787902*^9, 3.825345901364354*^9, 3.825347858144744*^9, 
   3.825347917666226*^9, 3.8253479851692467`*^9, 3.825348808054359*^9, {
   3.825422468428089*^9, 3.8254225037334023`*^9}, 3.8254241557559347`*^9, 
   3.8254244701131287`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"75941242-c624-403e-851e-f01c693835ad"]
}, Open  ]]
},
WindowSize->{1440., 789.75},
WindowMargins->{{Automatic, 1024.5}, {Automatic, 19.5}},
FrontEndVersion->"12.2 for Linux x86 (64-bit) (December 12, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"c3ab085c-f74a-46a8-ae5a-f8ca227e6f6c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 643, 15, 51, "Input",ExpressionUUID->"08958795-8b98-4b71-b68e-f52ccc3dbafd"],
Cell[1226, 39, 246, 4, 33, "Output",ExpressionUUID->"78df887f-dfcc-40ab-a3e7-b2655b8839bb"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1509, 48, 857, 18, 51, "Input",ExpressionUUID->"de30b4eb-4339-4b10-b7da-95f8dab52caf"],
Cell[2369, 68, 681, 10, 33, "Output",ExpressionUUID->"d08cc351-3f4d-4cd5-8374-8acae581de21"]
}, Open  ]],
Cell[3065, 81, 1419, 32, 154, "Input",ExpressionUUID->"72741d41-326c-4a5c-8703-8e3d5a917067"],
Cell[4487, 115, 1092, 27, 71, "Input",ExpressionUUID->"ab1b2a90-e06e-4549-8f34-c7b493ef75f6"],
Cell[5582, 144, 1415, 33, 92, "Input",ExpressionUUID->"4a3a05fa-b606-45e9-a21f-6bc703e74843"],
Cell[7000, 179, 962, 24, 71, "Input",ExpressionUUID->"44ef4fb5-0e07-4f2b-b516-cf8285ca4e74"],
Cell[7965, 205, 844, 20, 71, "Input",ExpressionUUID->"c11d02c3-de4c-4e4b-be15-2a228df96fe2"],
Cell[CellGroupData[{
Cell[8834, 229, 1080, 20, 51, "Input",ExpressionUUID->"3fe46f1a-a016-43a9-a09b-87406233436b"],
Cell[9917, 251, 718, 11, 33, "Output",ExpressionUUID->"d3637f32-66b6-449a-9a1b-a9b2e8c02d6f"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10672, 267, 1609, 28, 51, "Input",ExpressionUUID->"53496947-6b8d-4f94-aa89-f85d2b139864"],
Cell[12284, 297, 1287, 24, 23, "Print",ExpressionUUID->"0fbd575f-e6ce-42b2-a7fb-1f4318b715c8"],
Cell[13574, 323, 1428, 25, 82, "Output",ExpressionUUID->"75941242-c624-403e-851e-f01c693835ad"]
}, Open  ]]
}
]
*)

